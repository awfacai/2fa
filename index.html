<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="UTF-8" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1.0" />
        <meta
            http-equiv="X-UA-Compatible"
            content="IE=edge" />
        <meta
            name="description"
            content="TOTPÈ™åËØÅÁ†ÅÁîüÊàêÂô® - ÊîØÊåÅGoogle Authenticator„ÄÅMicrosoft AuthenticatorÁ≠âÂèåÂõ†Á¥†ËÆ§ËØÅÂ∫îÁî®ÁöÑÈ™åËØÅÁ†ÅÁîüÊàê" />
        <meta
            name="keywords"
            content="TOTP,È™åËØÅÁ†Å,ÂèåÂõ†Á¥†ËÆ§ËØÅ,2FA,Google Authenticator,Microsoft Authenticator,OTP" />
        <meta
            name="author"
            content="TOTP Generator" />
        <meta
            name="robots"
            content="noindex, nofollow" />
        <meta
            name="referrer"
            content="no-referrer" />

        <meta
            http-equiv="Content-Security-Policy"
            content="default-src 'self' 'unsafe-inline' 'unsafe-eval' https://unpkg.com; style-src 'self' 'unsafe-inline' https://unpkg.com; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://unpkg.com;" />

        <meta
            name="format-detection"
            content="telephone=no" />
        <meta
            name="apple-mobile-web-app-capable"
            content="yes" />
        <meta
            name="apple-mobile-web-app-status-bar-style"
            content="black-translucent" />
        <meta
            name="apple-mobile-web-app-title"
            content="TOTPÈ™åËØÅÁ†Å" />

        <link
            rel="icon"
            type="image/x-icon"
            href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiByeD0iNCIgZmlsbD0iIzAwNmVmZiIvPgo8dGV4dCB4PSIxNiIgeT0iMjAiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5UPC90ZXh0Pgo8L3N2Zz4K" />
        <link
            rel="apple-touch-icon"
            href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTgwIiBoZWlnaHQ9IjE4MCIgdmlld0JveD0iMCAwIDE4MCAxODAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxODAiIGhlaWdodD0iMTgwIiByeD0iMjAiIGZpbGw9IiMwMDZlZmYiLz4KPHR4dCB4PSI5MCIgeT0iMTEwIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iODAiIGZvbnQtd2VpZ2h0PSJib2xkIiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+VDwvdGV4dD4KPC9zdmc+Cg==" />

        <title>TOTP/2FAÈ™åËØÅÁ†ÅÁîüÊàêÂô® - ÂèåÂõ†Á¥†ËÆ§ËØÅÂ∑•ÂÖ∑</title>

        <link
            rel="preload"
            href="https://unpkg.com/vue@2/dist/vue.js"
            as="script" />
        <link
            rel="preload"
            href="https://unpkg.com/element-ui/lib/theme-chalk/index.css"
            as="style" />
        <link
            rel="preload"
            href="https://unpkg.com/element-ui/lib/index.js"
            as="script" />
        <link
            rel="preload"
            href="https://unpkg.com/otpauth@9.1.4/dist/otpauth.umd.min.js"
            as="script" />

        <link
            rel="stylesheet"
            href="https://unpkg.com/element-ui/lib/theme-chalk/index.css" />

        <script src="https://unpkg.com/vue@2/dist/vue.js"></script>
        <script src="https://unpkg.com/element-ui/lib/index.js"></script>
        <script src="https://unpkg.com/otpauth@9.1.4/dist/otpauth.umd.min.js"></script>

        <style>
            * {
                box-sizing: border-box;
            }

            body {
                margin: 0;
                padding: 20px;
                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell",
                    "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif;
                background-color: #f5f5f5;
                min-height: 100vh;
            }

            .totp {
                width: 520px;
                max-width: 100%;
                margin: 0 auto;
                margin-top: 30px;
            }

            .totp .code {
                text-align: center;
                padding: 20px 0;
            }

            .totp .code span {
                display: inline-block;
                font-size: 26px;
                font-weight: bold;
                border: 1px solid #000;
                padding: 5px 10px;
                border-radius: 4px;
                background-color: #fff;
                letter-spacing: 2px;
            }

            .totp .seconds {
                text-align: center;
                font-size: 12px;
                color: #666;
            }

            .totp .seconds b {
                font-size: 20px;
                color: #006eff;
            }

            .totp .card {
                position: relative;
            }

            .totp .press {
                position: absolute;
                left: 0;
                right: 0;
                bottom: 0;
                height: 5px;
                z-index: 10;
            }

            .totp .press span {
                position: absolute;
                left: 0;
                bottom: 0;
                background: #006eff;
                display: inline-block;
                height: 5px;
                width: 50%;
                transition: all 0.3s;
                border-radius: 0 0 4px 4px;
            }

            .setting {
                margin-top: 30px;
            }

            .setting .row {
                margin-bottom: 15px;
                display: flex;
                align-items: center;
            }

            .setting .row .label {
                width: 80px;
                text-align: right;
                font-weight: 500;
            }

            .setting .row .val {
                flex: 1;
            }

            .setting .tips {
                font-size: 12px;
                text-align: right;
                color: #999;
                margin-top: 10px;
            }

            .url-tip {
                margin-top: 20px;
            }

            .url-tip .tip-content {
                background: #f0f9ff;
                border: 1px solid #bfdbfe;
                border-radius: 6px;
                padding: 12px;
                font-size: 13px;
                color: #1e40af;
            }

            .url-tip .tip-title {
                font-weight: 600;
                margin-bottom: 8px;
                display: flex;
                align-items: center;
            }

            .url-tip .tip-title::before {
                content: "üí°";
                margin-right: 6px;
            }

            .url-example {
                background: #f8fafc;
                border: 1px solid #e2e8f0;
                border-radius: 4px;
                padding: 8px;
                margin-top: 8px;
                font-size: 12px;
                color: #475569;
                word-break: break-all;
            }

            .copy-btn {
                margin-left: 8px;
                font-size: 12px;
                padding: 2px 8px;
            }

            .page-header {
                text-align: center;
                padding: 20px 0;
            }

            .page-title {
                font-size: 28px;
                font-weight: 600;
                color: #1f2937;
                margin: 0 0 8px 0;
                letter-spacing: -0.5px;
            }

            .page-subtitle {
                font-size: 14px;
                color: #6b7280;
                margin: 0;
                font-weight: 400;
            }

            .site-footer {
                padding: 1.2rem 2rem;
                color: #000;
            }

            footer {
               
                left: 0;
                right: 0;
                bottom: 0;
                padding: 20px;
            }
            footer a {
                pointer-events: auto;
                color: #000;
            }
            footer span {
                font-size: 12px;
            }

            .footer-content {
                display: flex;
                gap: 0.8rem;
                align-items: center;
                justify-content: center;
                font-size: 0.9rem;
            }

            .github-link {
                display: inline-flex;
                align-items: center;
                gap: 0.4rem;
                text-decoration: none;
                transition: all 0.2s ease;
            }

            .github-link:hover {
                transform: translateY(-1px);
            }

            .github-icon {
                flex-shrink: 0;
            }

            .divider {
                user-select: none;
            }

            @media (max-width: 600px) {
                .totp {
                    width: 100%;
                    margin-top: 20px;
                }

                .totp .code span {
                    font-size: 22px;
                    padding: 8px 12px;
                }

                .setting .row {
                    flex-direction: column;
                    align-items: stretch;
                }

                .setting .row .label {
                    width: 100%;
                    text-align: left;
                    padding-right: 0;
                    margin-bottom: 5px;
                }
                footer {
                    position: relative;
                }
                .page-title {
                    font-size: 24px;
                }

                .page-subtitle {
                    font-size: 13px;
                    padding: 0 20px;
                }

                .footer-content {
                    flex-wrap: wrap;
                    gap: 0.8rem;
                    justify-content: center;
                }

                .divider {
                    display: none;
                }

                .github-text {
                    display: none;
                }

                .github-icon {
                    width: 20px;
                    height: 20px;
                }
            }

            .loading {
                display: flex;
                justify-content: center;
                align-items: center;
                height: 200px;
            }

            .error-message {
                color: #f56c6c;
                font-size: 12px;
                margin-top: 5px;
            }
        </style>
    </head>
    <body>
        <div id="app">
            <div class="page-header">
                <h1 class="page-title">TOTPÈ™åËØÅÁ†ÅÁîüÊàêÂô®</h1>
                <p class="page-subtitle">ÊîØÊåÅGoogle Authenticator„ÄÅMicrosoft AuthenticatorÁ≠âÂèåÂõ†Á¥†ËÆ§ËØÅÂ∫îÁî®</p>
            </div>
            <div class="totp">
                <div class="card">
                    <div class="press">
                        <span :style="getPress"></span>
                    </div>
                    <el-card>
                        <el-input
                            v-model.trim="secret"
                            placeholder="ËØ∑ËæìÂÖ•Base32Ê†ºÂºèÁöÑÂØÜÈí•"
                            :class="{ 'is-error': secretError }">
                            <el-button
                                slot="append"
                                @click="initTotp"
                                type="primary"
                                >Ëé∑Âèñ</el-button
                            >
                        </el-input>
                        <div
                            v-if="secretError"
                            class="error-message">
                            {{ secretError }}
                        </div>

                        <div
                            class="code"
                            v-if="code">
                            <span>{{ code }}</span>
                        </div>
                        <div
                            class="seconds"
                            v-if="code">
                            <span>Ââ©‰Ωô <b>{{ seconds }}</b> Áßí</span>
                        </div>
                    </el-card>
                </div>

                <div class="setting">
                    <el-card>
                        <div class="row">
                            <div class="label">Êó∂Êïà(Áßí)Ôºö</div>
                            <div class="val">
                                <el-input
                                    v-model.trim="period"
                                    type="number"
                                    :min="1"
                                    :max="300"
                                    placeholder="30"></el-input>
                            </div>
                        </div>
                        <div class="row">
                            <div class="label">ÈïøÂ∫¶Ôºö</div>
                            <div class="val">
                                <el-input
                                    v-model.trim="digits"
                                    type="number"
                                    :min="4"
                                    :max="10"
                                    placeholder="6"></el-input>
                            </div>
                        </div>

                        <div class="row">
                            <div class="label">ÁÆóÊ≥ïÔºö</div>
                            <div class="val">
                                <el-select
                                    style="width: 100%"
                                    v-model="algorithm"
                                    placeholder="ÈÄâÊã©ÁÆóÊ≥ï">
                                    <el-option
                                        label="SHA1"
                                        value="SHA1"></el-option>
                                    <el-option
                                        label="SHA256"
                                        value="SHA256"></el-option>
                                    <el-option
                                        label="SHA512"
                                        value="SHA512"></el-option>
                                </el-select>
                            </div>
                        </div>

                        <div class="tips">üí° ÊèêÁ§∫ÔºöÊØèÊ¨°‰øÆÊîπÂèÇÊï∞ÂêéÔºåÈúÄË¶ÅÈáçÊñ∞ÁÇπÂáª"Ëé∑Âèñ"ÊåâÈíÆ</div>
                    </el-card>
                </div>

                <!-- URLÂèÇÊï∞‰ΩøÁî®ÊèêÁ§∫ -->
                <div class="url-tip">
                    <el-card>
                        <div class="tip-content">
                            <div class="tip-title">Âø´ÈÄü‰ΩøÁî®ÊñπÂºè</div>
                            <div>ÊÇ®ÂèØ‰ª•ÈÄöËøáURLÂèÇÊï∞Áõ¥Êé•‰º†ÂÖ•ÂØÜÈí•ÔºåÊó†ÈúÄÊâãÂä®ËæìÂÖ•Ôºö</div>
                            <div class="url-example">
                                {{ currentUrl }}?code=YOUR_SECRET_KEY
                                <el-button
                                    class="copy-btn"
                                    size="mini"
                                    type="text"
                                    @click="copyUrlExample">
                                    Â§çÂà∂
                                </el-button>
                            </div>
                            <div style="margin-top: 8px; font-size: 12px; color: #64748b">
                                Â∞Ü YOUR_SECRET_KEY ÊõøÊç¢‰∏∫ÊÇ®ÁöÑÂÆûÈôÖÂØÜÈí•Âç≥ÂèØ
                            </div>
                        </div>
                    </el-card>
                </div>
            </div>

            <footer class="site-footer">
                <div class="footer-content">
                    <span class="brand">¬© 2024 WishMeLz.Design</span>

                    <span
                        class="divider"
                        aria-hidden="true"
                        >‚îÇ</span
                    >

                    <a
                        href="https://github.com/WishMelz/2fa"
                        target="_blank"
                        rel="noopener noreferrer"
                        class="github-link">
                        <svg
                            class="github-icon"
                            aria-hidden="true"
                            viewBox="0 0 16 16"
                            width="18"
                            height="18">
                            <path
                                fill="currentColor"
                                d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z" />
                        </svg>
                        <span class="github-text">Source Code</span>
                    </a>

                    <span
                        class="divider"
                        aria-hidden="true"
                        >‚îÇ</span
                    >

                    <span class="powered-by">Powered by ITSSE.CN</span>
                </div>
            </footer>
        </div>

        <script>
            new Vue({
                el: "#app",
                data() {
                    return {
                        totp: null,
                        secret: "JBSWY3DPEHPK3PXP",
                        period: 30,
                        code: "",
                        seconds: "",
                        timerData: null,
                        digits: 6,
                        algorithm: "SHA1",
                        showSetting: false,
                        secretError: "",
                        currentUrl: window.location.origin + window.location.pathname,
                    };
                },
                created() {
                    // Ëé∑ÂèñURLÂèÇÊï∞
                    const urlParams = new URLSearchParams(window.location.search);
                    const secret = urlParams.get("code");
                    if (secret) {
                        this.secret = secret;
                        // Â¶ÇÊûúÈÄöËøáURLÂèÇÊï∞‰º†ÂÖ•‰∫ÜÂØÜÈí•ÔºåÊòæÁ§∫ÊèêÁ§∫
                        this.$nextTick(() => {
                            this.$message.success("Â∑≤‰ªéURLÂèÇÊï∞‰∏≠Ëé∑ÂèñÂØÜÈí•");
                        });
                    }
                    this.initTotp();
                },
                computed: {
                    getPress() {
                        let press = (this.seconds / this.period) * 100;
                        return "width:" + (press > 100 ? 100 : press) + "%";
                    },
                },
                methods: {
                    initTotp() {
                        this.secretError = "";

                        if (!this.secret) {
                            this.secretError = "ËØ∑ËæìÂÖ•ÂØÜÈí•";
                            return;
                        }

                        try {
                            let totp = new OTPAuth.TOTP({
                                issuer: "TOTP Generator",
                                label: "User",
                                algorithm: this.algorithm,
                                digits: parseInt(this.digits) || 6,
                                period: parseInt(this.period) || 30,
                                secret: this.secret,
                            });

                            this.totp = totp;
                            this.code = totp.generate();
                            this.seconds = totp.period - (Math.floor(Date.now() / 1000) % totp.period);
                            this.timer();
                        } catch (error) {
                            this.secretError = "ÂØÜÈí•Ê†ºÂºèÈîôËØØÔºåËØ∑Ê£ÄÊü•Base32Ê†ºÂºè";
                            this.code = "";
                            this.seconds = "";
                            console.error("TOTPÁîüÊàêÈîôËØØ:", error);
                        }
                    },
                    timer() {
                        clearInterval(this.timerData);
                        this.timerData = setInterval(() => {
                            if (this.seconds <= 1) {
                                this.initTotp();
                                return;
                            }
                            this.seconds -= 1;
                        }, 1000);
                    },
                    copyUrlExample() {
                        const exampleUrl = `${this.currentUrl}?code=YOUR_SECRET_KEY`;

                        // Â∞ùËØï‰ΩøÁî®Áé∞‰ª£ÁöÑ Clipboard API
                        if (navigator.clipboard && window.isSecureContext) {
                            navigator.clipboard
                                .writeText(exampleUrl)
                                .then(() => {
                                    this.$message.success("URLÁ§∫‰æãÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø");
                                })
                                .catch(() => {
                                    this.fallbackCopy(exampleUrl);
                                });
                        } else {
                            this.fallbackCopy(exampleUrl);
                        }
                    },
                    fallbackCopy(text) {
                        // ÈôçÁ∫ßÊñπÊ°àÔºö‰ΩøÁî®‰º†ÁªüÁöÑÂ§çÂà∂ÊñπÊ≥ï
                        const textArea = document.createElement("textarea");
                        textArea.value = text;
                        textArea.style.position = "fixed";
                        textArea.style.left = "-999999px";
                        textArea.style.top = "-999999px";
                        document.body.appendChild(textArea);
                        textArea.focus();
                        textArea.select();

                        try {
                            document.execCommand("copy");
                            this.$message.success("URLÁ§∫‰æãÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø");
                        } catch (err) {
                            this.$message.warning("Â§çÂà∂Â§±Ë¥•ÔºåËØ∑ÊâãÂä®Â§çÂà∂");
                        }

                        document.body.removeChild(textArea);
                    },
                },
                beforeDestroy() {
                    if (this.timerData) {
                        clearInterval(this.timerData);
                    }
                },
            });
        </script>
    </body>
</html>
